(()=>{var e={};e.id=626,e.ids=[626],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},15673:e=>{"use strict";e.exports=require("node:events")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},47261:e=>{"use strict";e.exports=require("node:util")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},44776:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>o.a,__next_app__:()=>f,originalPathname:()=>l,pages:()=>u,routeModule:()=>p,tree:()=>d});var r=a(50482),s=a(69108),i=a(62563),o=a.n(i),n=a(68300),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);a.d(t,c);let d=["",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,29925)),"/Users/amr/web/jonas-attachment/ultimate-react-course/21-the-wild-oasis-website/final-6-after-server-actions/app/login/page.js"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,4998))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,57575)),"/Users/amr/web/jonas-attachment/ultimate-react-course/21-the-wild-oasis-website/final-6-after-server-actions/app/layout.js"],error:[()=>Promise.resolve().then(a.bind(a,60826)),"/Users/amr/web/jonas-attachment/ultimate-react-course/21-the-wild-oasis-website/final-6-after-server-actions/app/error.js"],loading:[()=>Promise.resolve().then(a.bind(a,65016)),"/Users/amr/web/jonas-attachment/ultimate-react-course/21-the-wild-oasis-website/final-6-after-server-actions/app/loading.js"],"not-found":[()=>Promise.resolve().then(a.bind(a,46178)),"/Users/amr/web/jonas-attachment/ultimate-react-course/21-the-wild-oasis-website/final-6-after-server-actions/app/not-found.js"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,4998))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/Users/amr/web/jonas-attachment/ultimate-react-course/21-the-wild-oasis-website/final-6-after-server-actions/app/login/page.js"],l="/login/page",f={require:a,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},10194:(e,t,a)=>{let r={"0bf97f42383149137074c11870878620a547d150":()=>Promise.resolve().then(a.bind(a,10752)).then(e=>e.createBooking),"18f7da8ac10e6a282f5997ecdbca04d0a0627840":()=>Promise.resolve().then(a.bind(a,10752)).then(e=>e.updateGuest),"39f44aa684ecad569efdd218e6736d19acac4a86":()=>Promise.resolve().then(a.bind(a,10752)).then(e=>e.signOutAction),"50c40ac78e12cda6365ac8f273c63091cf0864e0":()=>Promise.resolve().then(a.bind(a,10752)).then(e=>e.deleteBooking),ab6974b13bfbdbf93116a8ffcacd9b2466375819:()=>Promise.resolve().then(a.bind(a,10752)).then(e=>e.updateBooking),cf262e902b8674ded778f7999bf7aa0a0380055e:()=>Promise.resolve().then(a.bind(a,10752)).then(e=>e.signInAction)};async function s(e,...t){return(await r[e]()).apply(null,t)}e.exports={"0bf97f42383149137074c11870878620a547d150":s.bind(null,"0bf97f42383149137074c11870878620a547d150"),"18f7da8ac10e6a282f5997ecdbca04d0a0627840":s.bind(null,"18f7da8ac10e6a282f5997ecdbca04d0a0627840"),"39f44aa684ecad569efdd218e6736d19acac4a86":s.bind(null,"39f44aa684ecad569efdd218e6736d19acac4a86"),"50c40ac78e12cda6365ac8f273c63091cf0864e0":s.bind(null,"50c40ac78e12cda6365ac8f273c63091cf0864e0"),ab6974b13bfbdbf93116a8ffcacd9b2466375819:s.bind(null,"ab6974b13bfbdbf93116a8ffcacd9b2466375819"),cf262e902b8674ded778f7999bf7aa0a0380055e:s.bind(null,"cf262e902b8674ded778f7999bf7aa0a0380055e")}},10752:(e,t,a)=>{"use strict";a.r(t),a.d(t,{createBooking:()=>u,deleteBooking:()=>l,signInAction:()=>p,signOutAction:()=>b,updateBooking:()=>f,updateGuest:()=>d});var r=a(31542);a(68616);var s=a(42735),i=a(66563),o=a(61024),n=a(66864),c=a(867);async function d(e){let t=await (0,s.I8)();if(!t)throw Error("You must be logged in");let a=e.get("nationalID"),[r,i]=e.get("nationality").split("%");if(!/^[a-zA-Z0-9]{6,12}$/.test(a))throw Error("Please provide a valid national ID");let{data:c,error:d}=await o.O.from("guests").update({nationality:r,countryFlag:i,nationalID:a}).eq("id",t.user.guestId);if(d)throw Error("Guest could not be updated");(0,n.revalidatePath)("/account/profile")}async function u(e,t){let a=await (0,s.I8)();if(!a)throw Error("You must be logged in");let r={...e,guestId:a.user.guestId,numGuests:Number(t.get("numGuests")),observations:t.get("observations").slice(0,1e3),extrasPrice:0,totalPrice:e.cabinPrice,isPaid:!1,hasBreakfast:!1,status:"unconfirmed"},{error:i}=await o.O.from("bookings").insert([r]);if(i)throw Error("Booking could not be created");(0,n.revalidatePath)(`/cabins/${e.cabinId}`),(0,c.redirect)("/cabins/thankyou")}async function l(e){let t=await (0,s.I8)();if(!t)throw Error("You must be logged in");if(!(await (0,i.aL)(t.user.guestId)).map(e=>e.id).includes(e))throw Error("You are not allowed to delete this booking");let{error:a}=await o.O.from("bookings").delete().eq("id",e);if(a)throw Error("Booking could not be deleted");(0,n.revalidatePath)("/account/reservations")}async function f(e){let t=Number(e.get("bookingId")),a=await (0,s.I8)();if(!a)throw Error("You must be logged in");if(!(await (0,i.aL)(a.user.guestId)).map(e=>e.id).includes(t))throw Error("You are not allowed to update this booking");let r={numGuests:Number(e.get("numGuests")),observations:e.get("observations").slice(0,1e3)},{error:d}=await o.O.from("bookings").update(r).eq("id",t).select().single();if(d)throw Error("Booking could not be updated");(0,n.revalidatePath)(`/account/reservations/edit/${t}`),(0,n.revalidatePath)("/account/reservations"),(0,c.redirect)("/account/reservations")}async function p(){await (0,s.zB)("google",{redirectTo:"/account"})}async function b(){await (0,s.w7)({redirectTo:"/"})}(0,a(42053).h)([d,u,l,f,p,b]),(0,r.j)("18f7da8ac10e6a282f5997ecdbca04d0a0627840",d),(0,r.j)("0bf97f42383149137074c11870878620a547d150",u),(0,r.j)("50c40ac78e12cda6365ac8f273c63091cf0864e0",l),(0,r.j)("ab6974b13bfbdbf93116a8ffcacd9b2466375819",f),(0,r.j)("cf262e902b8674ded778f7999bf7aa0a0380055e",p),(0,r.j)("39f44aa684ecad569efdd218e6736d19acac4a86",b)},29925:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n,metadata:()=>o});var r=a(25036),s=a(10752);let i=function(){return r.jsx("form",{action:s.signInAction,children:(0,r.jsxs)("button",{className:"flex items-center gap-6 text-lg border border-primary-300 px-10 py-4 font-medium",children:[r.jsx("img",{src:"https://authjs.dev/img/providers/google.svg",alt:"Google logo",height:"24",width:"24"}),r.jsx("span",{children:"Continue with Google"})]})})},o={title:"Login"};function n(){return(0,r.jsxs)("div",{className:"flex flex-col gap-10 mt-10 items-center",children:[r.jsx("h2",{className:"text-3xl font-semibold",children:"Sign in to access your guest area"}),r.jsx(i,{})]})}}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[638,548,85,225,864,222,430],()=>a(44776));module.exports=r})();