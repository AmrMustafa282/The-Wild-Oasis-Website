exports.id=177,exports.ids=[177],exports.modules={51089:(e,t,a)=>{let r={"0bf97f42383149137074c11870878620a547d150":()=>Promise.resolve().then(a.bind(a,25567)).then(e=>e.createBooking),"18f7da8ac10e6a282f5997ecdbca04d0a0627840":()=>Promise.resolve().then(a.bind(a,25567)).then(e=>e.updateGuest),"39f44aa684ecad569efdd218e6736d19acac4a86":()=>Promise.resolve().then(a.bind(a,25567)).then(e=>e.signOutAction),"50c40ac78e12cda6365ac8f273c63091cf0864e0":()=>Promise.resolve().then(a.bind(a,25567)).then(e=>e.deleteBooking),ab6974b13bfbdbf93116a8ffcacd9b2466375819:()=>Promise.resolve().then(a.bind(a,25567)).then(e=>e.updateBooking),cf262e902b8674ded778f7999bf7aa0a0380055e:()=>Promise.resolve().then(a.bind(a,25567)).then(e=>e.signInAction)};async function n(e,...t){return(await r[e]()).apply(null,t)}e.exports={"0bf97f42383149137074c11870878620a547d150":n.bind(null,"0bf97f42383149137074c11870878620a547d150"),"18f7da8ac10e6a282f5997ecdbca04d0a0627840":n.bind(null,"18f7da8ac10e6a282f5997ecdbca04d0a0627840"),"39f44aa684ecad569efdd218e6736d19acac4a86":n.bind(null,"39f44aa684ecad569efdd218e6736d19acac4a86"),"50c40ac78e12cda6365ac8f273c63091cf0864e0":n.bind(null,"50c40ac78e12cda6365ac8f273c63091cf0864e0"),ab6974b13bfbdbf93116a8ffcacd9b2466375819:n.bind(null,"ab6974b13bfbdbf93116a8ffcacd9b2466375819"),cf262e902b8674ded778f7999bf7aa0a0380055e:n.bind(null,"cf262e902b8674ded778f7999bf7aa0a0380055e")}},82084:(e,t,a)=>{"use strict";a.d(t,{FF:()=>o,NH:()=>n,TB:()=>i,sF:()=>s}),a(13664);var r=a(28371),n=(0,r.$)("39f44aa684ecad569efdd218e6736d19acac4a86"),s=(0,r.$)("18f7da8ac10e6a282f5997ecdbca04d0a0627840"),i=(0,r.$)("0bf97f42383149137074c11870878620a547d150"),o=(0,r.$)("50c40ac78e12cda6365ac8f273c63091cf0864e0");(0,r.$)("ab6974b13bfbdbf93116a8ffcacd9b2466375819"),(0,r.$)("cf262e902b8674ded778f7999bf7aa0a0380055e")},89410:(e,t,a)=>{"use strict";a.d(t,{default:()=>n.a});var r=a(37412),n=a.n(r)},37412:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{getImageProps:function(){return o},default:function(){return c}});let r=a(39694),n=a(83855),s=a(31900),i=r._(a(74931)),o=e=>{let{props:t}=(0,n.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}},c=s.Image},25567:(e,t,a)=>{"use strict";a.r(t),a.d(t,{createBooking:()=>u,deleteBooking:()=>f,signInAction:()=>b,signOutAction:()=>g,updateBooking:()=>l,updateGuest:()=>d});var r=a(60398);a(75811);var n=a(20390),s=a(97411),i=a(2075),o=a(43811),c=a(52810);async function d(e){let t=await (0,n.auth)();if(!t)throw Error("You must be logged in");let a=e.get("nationalID"),[r,s]=e.get("nationality").split("%");if(!/^[a-zA-Z0-9]{6,12}$/.test(a))throw Error("Please provide a valid national ID");let{data:c,error:d}=await i.supabase.from("guests").update({nationality:r,countryFlag:s,nationalID:a}).eq("id",t.user.guestId);if(d)throw Error("Guest could not be updated");(0,o.revalidatePath)("/account/profile")}async function u(e,t){let a=await (0,n.auth)();if(!a)throw Error("You must be logged in");let r={...e,guestId:a.user.guestId,numGuests:Number(t.get("numGuests")),observations:t.get("observations").slice(0,1e3),extrasPrice:0,totalPrice:e.cabinPrice,isPaid:!1,hasBreakfast:!1,status:"unconfirmed"},{error:s}=await i.supabase.from("bookings").insert([r]);if(s)throw Error("Booking could not be created");(0,o.revalidatePath)(`/cabins/${e.cabinId}`),(0,c.redirect)("/cabins/thankyou")}async function f(e){let t=await (0,n.auth)();if(!t)throw Error("You must be logged in");if(!(await (0,s.getBookings)(t.user.guestId)).map(e=>e.id).includes(e))throw Error("You are not allowed to delete this booking");let{error:a}=await i.supabase.from("bookings").delete().eq("id",e);if(a)throw Error("Booking could not be deleted");(0,o.revalidatePath)("/account/reservations")}async function l(e){let t=Number(e.get("bookingId")),a=await (0,n.auth)();if(!a)throw Error("You must be logged in");if(!(await (0,s.getBookings)(a.user.guestId)).map(e=>e.id).includes(t))throw Error("You are not allowed to update this booking");let r={numGuests:Number(e.get("numGuests")),observations:e.get("observations").slice(0,1e3)},{error:d}=await i.supabase.from("bookings").update(r).eq("id",t).select().single();if(d)throw Error("Booking could not be updated");(0,o.revalidatePath)(`/account/reservations/edit/${t}`),(0,o.revalidatePath)("/account/reservations"),(0,c.redirect)("/account/reservations")}async function b(){await (0,n.signIn)("google",{redirectTo:"/account"})}async function g(){await (0,n.signOut)({redirectTo:"/"})}(0,a(46893).ensureServerEntryExports)([d,u,f,l,b,g]),(0,r.registerServerReference)("18f7da8ac10e6a282f5997ecdbca04d0a0627840",d),(0,r.registerServerReference)("0bf97f42383149137074c11870878620a547d150",u),(0,r.registerServerReference)("50c40ac78e12cda6365ac8f273c63091cf0864e0",f),(0,r.registerServerReference)("ab6974b13bfbdbf93116a8ffcacd9b2466375819",l),(0,r.registerServerReference)("cf262e902b8674ded778f7999bf7aa0a0380055e",b),(0,r.registerServerReference)("39f44aa684ecad569efdd218e6736d19acac4a86",g)},20390:(e,t,a)=>{"use strict";a.d(t,{auth:()=>o,signIn:()=>c,signOut:()=>d});var r=a(29538),n=a(67152),s=a(97411);let i={providers:[(0,n.default)({clientId:process.env.AUTH_GOOGLE_ID,clientSecret:process.env.AUTH_GOOGLE_SECRET})],callbacks:{authorized:({auth:e,request:t})=>!!e?.user,async signIn({user:e,account:t,profile:a}){try{return await (0,s.getGuest)(e.email)||await (0,s.createGuest)({email:e.email,fullName:e.name}),!0}catch{return!1}},async session({session:e,user:t}){let a=await (0,s.getGuest)(e.user.email);return e.user.guestId=a.id,e}},pages:{signIn:"/login"}},{auth:o,signIn:c,signOut:d,handlers:{GET:u,POST:f}}=(0,r.default)(i)},97411:(e,t,a)=>{"use strict";a.d(t,{createGuest:()=>i,getBookings:()=>s,getGuest:()=>n}),a(52810);var r=a(2075);async function n(e){let{data:t,error:a}=await r.supabase.from("guests").select("*").eq("email",e).single();return t}async function s(e){let{data:t,error:a,count:n}=await r.supabase.from("bookings").select("id, created_at, startDate, endDate, numNights, numGuests, totalPrice, guestId, cabinId, cabins(name, image)").eq("guestId",e).order("startDate");if(a)throw console.error(a),Error("Bookings could not get loaded");return t}async function i(e){let{data:t,error:a}=await r.supabase.from("guests").insert([e]);if(a)throw console.error(a),Error("Guest could not be created");return t}},2075:(e,t,a)=>{"use strict";a.d(t,{supabase:()=>r});let r=(0,a(53094).createClient)(process.env.SUPABASE_URL,process.env.SUPABASE_KEY)},4474:(e,t,a)=>{"use strict";a.d(t,{T:()=>n});var r=a(60522);function n(e,t){let a=(0,r.Q)(e),n=(0,r.Q)(t);return 12*(a.getFullYear()-n.getFullYear())+(a.getMonth()-n.getMonth())}},15802:(e,t,a)=>{"use strict";a.d(t,{V:()=>n});var r=a(60522);function n(e){let t=(0,r.Q)(e),a=t.getMonth();return t.setFullYear(t.getFullYear(),a+1,0),t.setHours(23,59,59,999),t}},54019:(e,t,a)=>{"use strict";a.d(t,{C:()=>n});var r=a(60522);function n(e){return+(0,r.Q)(e)<Date.now()}},11657:(e,t,a)=>{"use strict";a.d(t,{K:()=>n});var r=a(63519);function n(e,t){return+(0,r.b)(e)==+(0,r.b)(t)}}};